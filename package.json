{
    "name": "tomvisions-api",
    "version": "2.1.1",
    "description": "Example application for running a Node Express app on AWS Lambda using Amazon API Gateway.",
    "main": "lambda.js",
    "config": {
        "s3BucketNameStage": "tomvisions-api-stage",
        "s3BucketNameProduction": "tomvisions-api-production",
        "region": "us-east-1",
        "cloudFormationStackNameStage": "tomvisionsAPIStageStack",
        "cloudFormationStackNameProduction": "tomvisionsAPIProdStack",
        "domainStage": "api-stage.tomvisions.com",
        "domainProduction": "api.tomvisions.com",
        "certificate": "tomvisions.ca",
        "bucketNameImages": "images.mamboleofc.ca"
    },
    "scripts": {
        "build": "tsc --project .",
        "postbuild": "cp -R src/views dist/ && cp package*json dist/ ",
        "create-bucketStage": "cross-var aws s3 mb s3://$npm_package_config_s3BucketNameStage --region $npm_package_config_region",
        "create-bucketProduction": "cross-var aws s3 mb s3://$npm_package_config_s3BucketNameProduction --region $npm_package_config_region",
        "delete-bucket": "cross-var aws s3 rb s3://$npm_package_config_s3BucketName --region $npm_package_config_region",
        "delete-stack": "cross-var aws cloudformation delete-stack --stack-name $npm_package_config_cloudFormationStackName --region $npm_package_config_region",
        "develop": "nodemon --config nodemon.json",
        "invoke-lambda": "cross-var aws lambda invoke --function-name $npm_package_config_functionName --region $npm_package_config_region --cli-binary-format raw-in-base64-out --payload file://api-gateway-event.json lambda-invoke-response.json && cat lambda-invoke-response.json",
        "local": "ts-node scripts/local",
        "sam:build": "sam build --template sam-template.yaml",
        "sam:deploy:stage": "cross-var sam deploy --stack-name $npm_package_config_cloudFormationStackNameStage --capabilities CAPABILITY_IAM --s3-bucket $npm_package_config_s3BucketNameStage --s3-prefix $npm_package_name --parameter-overrides DomainName=$npm_package_config_domainStage Certificate=$npm_package_config_certificate BucketNameImages=$npm_package_config_bucketNameImages Stage=$STAGE DbHost=$DB_HOST DbUserName=$DB_USERNAME DbName=$DB_NAME DbPassword=$DB_PASSWORD NodeEnv=$NODE_ENV --region $npm_package_config_region --no-fail-on-empty-changeset",
        "sam:deploy:production": "cross-var sam deploy --stack-name $npm_package_config_cloudFormationStackNameProduction --capabilities CAPABILITY_IAM --s3-bucket $npm_package_config_s3BucketNameProduction --s3-prefix $npm_package_name --parameter-overrides DomainName=$npm_package_config_domainProduction Certificate=$npm_package_config_certificate BucketNameImages=$npm_package_config_bucketNameImages  Stage=$STAGE DbHost=$DB_HOST DbUserName=$DB_USERNAME DbName=$DB_NAME DbPassword=$DB_PASSWORD NodeEnv=$NODE_ENV --region $npm_package_config_region --no-fail-on-empty-changeset",
        "package-deploy-stage": "npm run sam:build && npm run sam:deploy:stage",
        "package-deploy-production": "npm run sam:build && npm run sam:deploy:production",
        "setup": "npm run setup-stage && npm run setup-production",
        "setup-stage": "npm install && (cross-var aws s3api get-bucket-location --bucket $npm_package_config_s3BucketNameStage --region $npm_package_config_region || npm run create-bucketStage) && npm run package-deploy-stage",
        "setup-production": "npm install && (cross-var aws s3api get-bucket-location --bucket $npm_package_config_s3BucketNameProduction --region $npm_package_config_region || npm run create-bucketProduction) && npm run package-deploy-production",
        "deploy-stage": "npm run environment && npm run build && npm run package-deploy-stage",
        "deploy-production": "npm run environment && npm run build && npm run package-deploy-production",
        "environment": "cross-env DB_USERNAME=$DB_USERNAME DB_PASSWORD=$DB_PASSWORD DB_HOST=$DB_HOST NODE_ENV=$NODE_ENV  DB_NAME=$DB_NAME  TOKEN_SECRET=$TOKEN_SECRET STAGE=$STAGE",
        "start": "cross-env DEBUG=http ts-node src/app.local",
        "test": "find ./dist/test -name '*.js' | xargs nyc --nyc-path ./.nycrc mocha -R spec",
        "test:watch": "npm test -- -- -w"
    },
    "license": "Apache-2.0",
    "dependencies": {
        "@aws-sdk/client-s3": "^3.441.0",
        "@aws-sdk/client-ses": "^3.435.0",
        "@vendia/serverless-express": "^4.10.1",
        "body-parser": "^1.17.1",
        "check-image-type": "^0.1.4",
        "child_process": "^1.0.2",
        "commander": "^9.3.0",
        "compression": "^1.6.2",
        "cors": "^2.8.3",
        "crypto": "^1.0.1",
        "crypto-js": "^4.2.0",
        "dotenv": "^16.0.3",
        "ejs": "^3.1.8",
        "express": "^4.17.1",
        "express-fileupload": "^1.4.0",
        "fs": "^0.0.1-security",
        "fs-extra": "^10.1.0",
        "image-size": "^1.0.2",
        "image-type": "^5.1.0",
        "jq": "^1.7.2",
        "js": "^0.1.0",
        "lodash-es": "^4.17.21",
        "mime": "^3.0.0",
        "moment": "^2.29.3",
        "mongoose": "^7.6.3",
        "multer": "^1.4.5-lts.1",
        "mysql": "^2.18.1",
        "mysql2": "^3.9.4",
        "njwt": "^1.2.0",
        "read-chunk": "^4.0.3",
        "request": "^2.88.2",
        "sequelize": "^6.35.0",
        "source-map-support": "^0.5.21",
        "ts-node": "^10.8.1",
        "tslib": "^2.3.1",
        "uuid": "^8.3.2"
    },
    "devDependencies": {
        "@types/aws-lambda": "^8.10.100",
        "@types/chai": "^4.2.21",
        "@types/compression": "^1.7.1",
        "@types/cors": "^2.8.12",
        "@types/crypto-js": "^4.1.1",
        "@types/ejs": "^3.1.0",
        "@types/express": "^4.17.13",
        "@types/helmet": "^4.0.0",
        "@types/jasmine": "^4.0.3",
        "@types/lodash": "^4.14.182",
        "@types/lodash-es": "^4.17.6",
        "@types/mocha": "^9.0.0",
        "@types/node": "^17.0.39",
        "@types/supertest": "^2.0.11",
        "chai": "^4.3.4",
        "chai-spies": "^1.0.0",
        "cross-env": "^7.0.3",
        "cross-var-no-babel": "^1.2.0",
        "mocha": "^9.1.1",
        "nodemon": "^2.0.22",
        "nyc": "^15.1.0",
        "rewire": "^6.0.0",
        "supertest": "^6.1.6",
        "typescript": "^4.7.3"
    }
}
